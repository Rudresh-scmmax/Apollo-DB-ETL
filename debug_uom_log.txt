Reading uom_master for table uom_master...
Read 53 rows
Connecting to DB...
[DB] Using Lambda function 'client1-private_db_query' for all database operations
Running stage_and_upsert...
    [DEBUG] stage_and_upsert: Starting with 53 rows for table uom_master
DB_LAMBDA_EXECUTING
    [DEBUG] stage_and_upsert: Using 6 columns: ['uom_id', 'uom_name', 'uom_symbol', 'measurement_type', 'uom_system']...
    [DEBUG] Fixing JSONB columns for uom_master: ['synonyms']
DB_LAMBDA_EXECUTING
    [DEBUG] Initial row count in uom_master: 49
    [DEBUG] Before FK filtering: 53 rows
    [DEBUG] FK filtering enabled for uom_master: starting with 53 rows
  [SKIP ALL] FK validation completely skipped for master table 'uom_master' (database will enforce FK constraints during INSERT)
    [DEBUG] FK filtering result: 53 rows valid, 0 rows filtered out
    [DEBUG] Using Lambda connection - will use VALUES clause instead of staging table
    [DEBUG] Executing UPSERT with VALUES clause for Lambda connection
    [DEBUG] SQL with RETURNING: 
                    INSERT INTO uom_master ("uom_id", "uom_name", "uom_symbol", "measurement_type", "uom_system", "synonyms")
                    VALUES (1, 'Grams', 'gms', 'Mass', 'Metric', '["g", "gram"]'), (2, 'Kilograms', 'kg', 'Mass', 'Metric', '["kgs", "kilo", "kilograms"]'), (3, 'Milligrams', 'mg', 'Mass', 'Metric', '["milli grams"]'), (4, 'Metric Tons', 'MT', 'Mass', 'Metric', '["Tonnes", "tonnes", "t"]'), (5, 'Pounds', 'lb', 'Mass', 'Imperial', '["lbs", "pound"]'), (6, 'Ounces', 'oz', 'Mass', 'Imperial', '["ozs"]'), (7, 'Liters', 'L', 'Volume', 'Metric', '["litres", "l"]'), (8, 'Milliliters', 'mL', 'Volume', 'Metric', '["ml", "milli litres"]'), (9, 'Cubic Meters', 'm³', 'Volume', 'Metric', '["cubic metres", "CBM"]'), (10, 'Cubic Centimeters', 'cm³', 'Volume', 'Metric', '["cc"]'), (11, 'Gallons (US)', 'gal', 'Volume', 'US Customary', '["gallons"]'), (12, 'Quarts (US)', 'qt', 'Volume', 'US Customary', '["quart"]'), (13, 'Barrels (Oil)', 'bbl', 'Volume', 'Oil & Gas/US', '["bbls"]'), (14, 'Drums', 'drum', 'Container/Volume Unit', 'Trade Standard', '["200L drum", "55 gal drum"]'), (15, 'Totes (Intermediate Bulk Container)', 'IBC', 'Container/Volume Unit', 'Trade Standard', '["tote tank", "1000L tote"]'), (16, 'Molarity', 'mol/L', 'Concentration', 'Metric', '["M"]'), (17, 'Parts per Million', 'ppm', 'Concentration', 'Universal', NULL), (18, 'Parts per Billion', 'ppb', 'Concentration', 'Universal', NULL), (19, 'Weight per Volume', '%% w/v', 'Concentration', 'Metric', NULL), (20, 'Volume per Volume', '%% v/v', 'Concentration', 'Metric', NULL), (21, 'Weight per Weight', '%% w/w', 'Concentration', 'Metric', NULL), (22, 'Celsius', '°C', 'Temperature', 'Metric', '["Centigrade"]'), (23, 'Fahrenheit', '°F', 'Temperature', 'Imperial', NULL), (24, 'Kelvin', 'K', 'Temperature', 'SI Unit', NULL), (25, 'Pascal', 'Pa', 'Pressure', 'SI Unit', NULL), (26, 'Kilopascal', 'kPa', 'Pressure', 'SI Unit', NULL), (27, 'Atmospheres', 'atm', 'Pressure', 'Universal', NULL), (28, 'Millimeters of Mercury', 'mmHg', 'Pressure', 'Metric', '["Torr"]'), (29, 'Inches of Mercury', 'inHg', 'Pressure', 'Imperial', NULL), (30, 'Hours', 'h', 'Time', 'Universal', '["hrs"]'), (31, 'Minutes', 'min', 'Time', 'Universal', '["mins"]'), (32, 'Seconds', 's', 'Time', 'Universal', '["secs"]'), (33, 'Moles', 'mol', 'Amount of substance', 'SI Unit', NULL), (34, 'Meter', 'm', 'Length', 'Metric', '["metre"]'), (35, 'Centimeter', 'cm', 'Length', 'Metric', NULL), (36, 'Millimeter', 'mm', 'Length', 'Metric', NULL), (37, 'Kilometer', 'km', 'Length', 'Metric', NULL), (38, 'Inch', 'in', 'Length', 'Imperial', '["inches"]'), (39, 'Foot', 'ft', 'Length', 'Imperial', '["feet"]'), (40, 'Yard', 'yd', 'Length', 'Imperial', '["yards"]'), (41, 'Mile', 'mi', 'Length', 'Imperial', '["miles"]'), (42, 'Density', 'kg/m³', 'Density', 'Metric', NULL), (43, 'Specific Gravity', 'SG', 'Relative Density (unitless)', 'Universal', NULL), (44, 'Specific Heat Capacity', 'J/(g·°C)', 'Heat Capacity', 'SI Unit', NULL), (45, 'Electric Current', 'A', 'Electric Current', 'SI Unit', '["Amp", "Amps", "Ampere"]'), (46, 'Conductivity', 'S/m', 'Conductivity', 'SI Unit', '["Siemens per meter"]'), (47, 'Luminous Intensity', 'cd', 'Luminous Intensity', 'SI Unit', '["candela"]'), (48, 'Percentage', '%%', 'Proportion', 'Universal', NULL), (49, 'Mole Fraction', 'mol/mol', 'Proportion', 'SI Unit', NULL), (50, 'Number of Units', 'EA', 'Count', 'Commercial', '["Each", "Unit", "Nos"]'), (51, 'Pack', 'PK', 'Package Count', 'Commercial', '["Packs", "Pkt"]'), (52, 'Pallet', 'PLT', 'Logistics Unit', 'Commercial', NULL), (53, 'Bag', 'BAG', 'Container Unit', 'Commercial', '["Sack", "Pouch"]')
                    ON CONFLICT ("uom_id") DO UPDATE SET "uom_name" = EXCLUDED."uom_name", "uom_symbol" = EXCLUDED."uom_symbol", "measurement_type" = EXCLUDED."measurement_type", "uom_system" = EXCLUDED."uom_system", "synonyms" = EXCLUDED."synonyms"
                    RETURNING xmax = 0 AS inserted;
                    
    [DEBUG] SQL without RETURNING: 
                    INSERT INTO uom_master ("uom_id", "uom_name", "uom_symbol", "measurement_type", "uom_system", "synonyms")
                    VALUES (1, 'Grams', 'gms', 'Mass', 'Metric', '["g", "gram"]'), (2, 'Kilograms', 'kg', 'Mass', 'Metric', '["kgs", "kilo", "kilograms"]'), (3, 'Milligrams', 'mg', 'Mass', 'Metric', '["milli grams"]'), (4, 'Metric Tons', 'MT', 'Mass', 'Metric', '["Tonnes", "tonnes", "t"]'), (5, 'Pounds', 'lb', 'Mass', 'Imperial', '["lbs", "pound"]'), (6, 'Ounces', 'oz', 'Mass', 'Imperial', '["ozs"]'), (7, 'Liters', 'L', 'Volume', 'Metric', '["litres", "l"]'), (8, 'Milliliters', 'mL', 'Volume', 'Metric', '["ml", "milli litres"]'), (9, 'Cubic Meters', 'm³', 'Volume', 'Metric', '["cubic metres", "CBM"]'), (10, 'Cubic Centimeters', 'cm³', 'Volume', 'Metric', '["cc"]'), (11, 'Gallons (US)', 'gal', 'Volume', 'US Customary', '["gallons"]'), (12, 'Quarts (US)', 'qt', 'Volume', 'US Customary', '["quart"]'), (13, 'Barrels (Oil)', 'bbl', 'Volume', 'Oil & Gas/US', '["bbls"]'), (14, 'Drums', 'drum', 'Container/Volume Unit', 'Trade Standard', '["200L drum", "55 gal drum"]'), (15, 'Totes (Intermediate Bulk Container)', 'IBC', 'Container/Volume Unit', 'Trade Standard', '["tote tank", "1000L tote"]'), (16, 'Molarity', 'mol/L', 'Concentration', 'Metric', '["M"]'), (17, 'Parts per Million', 'ppm', 'Concentration', 'Universal', NULL), (18, 'Parts per Billion', 'ppb', 'Concentration', 'Universal', NULL), (19, 'Weight per Volume', '%% w/v', 'Concentration', 'Metric', NULL), (20, 'Volume per Volume', '%% v/v', 'Concentration', 'Metric', NULL), (21, 'Weight per Weight', '%% w/w', 'Concentration', 'Metric', NULL), (22, 'Celsius', '°C', 'Temperature', 'Metric', '["Centigrade"]'), (23, 'Fahrenheit', '°F', 'Temperature', 'Imperial', NULL), (24, 'Kelvin', 'K', 'Temperature', 'SI Unit', NULL), (25, 'Pascal', 'Pa', 'Pressure', 'SI Unit', NULL), (26, 'Kilopascal', 'kPa', 'Pressure', 'SI Unit', NULL), (27, 'Atmospheres', 'atm', 'Pressure', 'Universal', NULL), (28, 'Millimeters of Mercury', 'mmHg', 'Pressure', 'Metric', '["Torr"]'), (29, 'Inches of Mercury', 'inHg', 'Pressure', 'Imperial', NULL), (30, 'Hours', 'h', 'Time', 'Universal', '["hrs"]'), (31, 'Minutes', 'min', 'Time', 'Universal', '["mins"]'), (32, 'Seconds', 's', 'Time', 'Universal', '["secs"]'), (33, 'Moles', 'mol', 'Amount of substance', 'SI Unit', NULL), (34, 'Meter', 'm', 'Length', 'Metric', '["metre"]'), (35, 'Centimeter', 'cm', 'Length', 'Metric', NULL), (36, 'Millimeter', 'mm', 'Length', 'Metric', NULL), (37, 'Kilometer', 'km', 'Length', 'Metric', NULL), (38, 'Inch', 'in', 'Length', 'Imperial', '["inches"]'), (39, 'Foot', 'ft', 'Length', 'Imperial', '["feet"]'), (40, 'Yard', 'yd', 'Length', 'Imperial', '["yards"]'), (41, 'Mile', 'mi', 'Length', 'Imperial', '["miles"]'), (42, 'Density', 'kg/m³', 'Density', 'Metric', NULL), (43, 'Specific Gravity', 'SG', 'Relative Density (unitless)', 'Universal', NULL), (44, 'Specific Heat Capacity', 'J/(g·°C)', 'Heat Capacity', 'SI Unit', NULL), (45, 'Electric Current', 'A', 'Electric Current', 'SI Unit', '["Amp", "Amps", "Ampere"]'), (46, 'Conductivity', 'S/m', 'Conductivity', 'SI Unit', '["Siemens per meter"]'), (47, 'Luminous Intensity', 'cd', 'Luminous Intensity', 'SI Unit', '["candela"]'), (48, 'Percentage', '%%', 'Proportion', 'Universal', NULL), (49, 'Mole Fraction', 'mol/mol', 'Proportion', 'SI Unit', NULL), (50, 'Number of Units', 'EA', 'Count', 'Commercial', '["Each", "Unit", "Nos"]'), (51, 'Pack', 'PK', 'Package Count', 'Commercial', '["Packs", "Pkt"]'), (52, 'Pallet', 'PLT', 'Logistics Unit', 'Commercial', NULL), (53, 'Bag', 'BAG', 'Container Unit', 'Commercial', '["Sack", "Pouch"]')
                    ON CONFLICT ("uom_id") DO UPDATE SET "uom_name" = EXCLUDED."uom_name", "uom_symbol" = EXCLUDED."uom_symbol", "measurement_type" = EXCLUDED."measurement_type", "uom_system" = EXCLUDED."uom_system", "synonyms" = EXCLUDED."synonyms";
                    
DB_LAMBDA_EXECUTING
    [DEBUG] UPSERT completed: 53 RETURNING rows, 53 rows processed (4 inserted, 49 updated)
DB_LAMBDA_EXECUTING
    [DEBUG] Row count verification: 49 -> 53 (added: 4)
    [WARNING] Only 4 rows were actually inserted, but 53 rows were processed
    [DEBUG] UPSERT completed: 53 total rows processed (4 inserted, 49 updated)
Result: inserted=4, updated=49, rejected=0
DB_LAMBDA_EXECUTING
Final count in DB: {'column_0': 53}
